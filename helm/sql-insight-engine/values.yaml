# Default values for sql-insight-engine
# This is a YAML-formatted file.

# Global settings
global:
  imagePullPolicy: IfNotPresent
  storageClass: local-path

# API Service
api:
  enabled: true
  replicaCount: 1
  image:
    repository: sql-insight-engine-api
    tag: latest
    pullPolicy: Never  # Override for local image
  service:
    type: NodePort
    port: 8000
    nodePort: 30001
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  env:
    pythonUnbuffered: "1"

# MCP Services
mcpPostgres:
  enabled: true
  replicaCount: 3
  image:
    repository: sql-insight-engine-mcp-postgres
    tag: latest
    pullPolicy: Never  # Override for local image
  service:
    port: 8001
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"

mcpChroma:
  enabled: true
  replicaCount: 3
  image:
    repository: sql-insight-engine-mcp-chroma
    tag: latest
    pullPolicy: Never  # Override for local image
  service:
    port: 8002
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"

mcpRegistry:
  enabled: true
  replicaCount: 2
  image:
    repository: sql-insight-engine-mcp-registry
    tag: latest
    pullPolicy: Never  # Override for local image
  service:
    port: 8010
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "100m"

# Infrastructure Services
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "15"
  service:
    port: 5432
  persistence:
    enabled: true
    size: 5Gi
  env:
    database: insight_engine
    user: admin
    password: password

externalTestDb:
  enabled: true
  image:
    repository: postgres
    tag: "15"
  service:
    port: 5432
  persistence:
    enabled: true
    size: 2Gi
  env:
    database: external_test_db
    user: admin
    password: password

redis:
  enabled: true
  image:
    repository: redis
    tag: 7-alpine
  service:
    port: 6379
  persistence:
    enabled: true
    size: 1Gi

rabbitmq:
  enabled: true
  image:
    repository: rabbitmq
    tag: 3-management
  service:
    port: 5672
    managementPort: 15672
  env:
    user: guest
    password: guest
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"

chromadb:
  enabled: true
  image:
    repository: chromadb/chroma
    tag: latest
  service:
    port: 8000
  persistence:
    enabled: true
    size: 5Gi

minio:
  enabled: true
  image:
    repository: minio/minio
    tag: latest
  service:
    port: 9000
    consolePort: 9001
  persistence:
    enabled: true
    size: 10Gi
  env:
    rootUser: minioadmin
    rootPassword: minioadmin123

# Observability Stack
prometheus:
  enabled: true
  image:
    repository: prom/prometheus
    tag: latest
  service:
    type: NodePort
    port: 9090
    nodePort: 30090
  persistence:
    enabled: true
    size: 5Gi

grafana:
  enabled: true
  image:
    repository: grafana/grafana
    tag: latest
  service:
    type: NodePort
    port: 3000
    nodePort: 30300
  persistence:
    enabled: true
    size: 2Gi
  env:
    adminUser: admin
    adminPassword: admin

loki:
  enabled: true
  image:
    repository: grafana/loki
    tag: 2.9.0
  service:
    port: 3100
  persistence:
    enabled: true
    size: 5Gi

promtail:
  enabled: true
  image:
    repository: grafana/promtail
    tag: 2.9.0

traefik:
  enabled: true
  image:
    repository: traefik
    tag: v2.10
  service:
    type: NodePort
    httpPort: 80
    httpsPort: 443
    dashboardPort: 8080
    httpNodePort: 30080
    dashboardNodePort: 30808

# Secrets
secrets:
  geminiApiKey: ""  # Set via --set secrets.geminiApiKey=<your-key>
  
# ConfigMaps
configMaps:
  enabled: true
